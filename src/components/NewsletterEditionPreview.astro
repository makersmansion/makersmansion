---
import { Image } from "astro:assets"
import { resolveCoverImage } from "~/content/newsletter/_resolveImage.js"
import { format } from "date-fns"

export type Props = {
  edition: {
    slug: string
    data: {
      title: string
      publishDate: Date
      coverImage: string
    }
  }
}
const { edition } = Astro.props

const image = await resolveCoverImage(edition)
---

<article class="@container">
  <a
    href={`/newsletter/${edition.slug}/`}
    data-astro-prefetch
    class="group flex h-full flex-col items-start gap-3 transition-colors @md:flex-row @md:items-center @md:gap-6">
    <figure
      class="relative isolate origin-center overflow-hidden rounded-lg transition-transform after:pointer-events-none after:absolute after:inset-0 after:bg-[url(/images/noise.svg)] after:opacity-75 after:brightness-100 after:contrast-150 after:saturate-200 group-hover:scale-95 @md:w-1/5">
      <Image
        src={image}
        alt={edition.data.title}
        width={image.width}
        height={image.height}
        class="aspect-video object-cover"
      />
    </figure>
    <div class="flex-1 px-2 @md:px-0">
      <h2 class="font-bold leading-tight [text-wrap:pretty] group-hover:text-primary-600">
        {edition.data.title}
      </h2>
      <time
        datetime={edition.data.publishDate.toISOString()}
        class="mt-1 block rounded-sm text-sm font-semibold text-neutral-500"
        >{format(edition.data.publishDate, "d MMM yyyy")}</time
      >
    </div>
  </a>
</article>
